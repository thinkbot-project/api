upstream compute_service {
    server unix:///tmp/api.thinkbot.net.sock;
}

server {
  listen 80;
  server_name www.thinkbot.net;
  rewrite ^/(.*) http://thinkbot.net/$1 permanent;
}

server {
  listen 80;
  server_name thinkbot.net;
  access_log /home/ubuntu/sites/thinkbot.net/logs/nginx/static_website_access.log;
  error_log /home/ubuntu/sites/thinkbot.net/logs/nginx/static_website_error.log;
  location / {
    root   /home/ubuntu/sites/thinkbot.net/static_website/public;
    index  index.html;
  }
}

server {
  listen 80;
  server_name docs.thinkbot.net;
  access_log /home/ubuntu/sites/thinkbot.net/logs/nginx/docs_access.log;
  error_log /home/ubuntu/sites/thinkbot.net/logs/nginx/docs_error.log;
  location / {
    root   /home/ubuntu/sites/thinkbot.net/docs/build/html;
    index  index.html;
  }
}

server {
  listen 80;
  server_name api.thinkbot.net;
  access_log /home/ubuntu/sites/thinkbot.net/logs/nginx/compute_server_access.log;
  error_log /home/ubuntu/sites/thinkbot.net/logs/nginx/compute_server_error.log;
  charset utf-8;

  client_max_body_size 75M;

  location /results  {
    alias /home/ubuntu/sites/thinkbot.net/compute_service/results;
    gzip_static on;
    expires max;
    add_header Cache-Control public;
    add_header Access-Control-Allow-Origin *;
  }

  location /static {
    alias /home/ubuntu/sites/thinkbot.net/compute_service/static;
  }

  location / {
    uwsgi_pass  compute_service;
    include     /home/ubuntu/sites/thinkbot.net/config/uwsgi/uwsgi_params;
  }
}
