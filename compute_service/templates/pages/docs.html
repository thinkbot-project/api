{% extends "layouts/base.html" %}

{% block title %}API Documentation &mdash; thinkbot{% endblock %}

{% block content %}
{% if user.is_authenticated %}
<div class="alert alert-success">
  Welcome {{ user.username }}. Your Authorization Token for the following REST requests is: <strong>{{ user_token }}</strong>.
</div>
{% endif %}
<h1>thinkbot API Reference <small>v 1.0</small></h1>
<p class="lead">thinkbot provides a friendly and powerful REST API that allows you to run sophisticated scientific software from just about anywhere.</p>
<p>Following convention, thinkbot&#8217;s API is organised as a <a href="#resources">set of resources</a> that can manipulated with well-defined requests to the service. All requests to the API go over <code>https</code> and use the <code>application/json</code> content type. The base URL to access this current version of the API is <code>https://thinkbot.net/api/v1</code>.</p>
<p>If you have questions or feedback on the API, please get in <a href="">touch with me</a>.</p>
{% if not user.is_authenticated %}
<p><a class="btn btn-success btn-lg" href="{% url 'registration_register' %}">Try thinkbot</a></p>
{% endif %}
<h2 id="getting-started-with-thinkbot">Getting started with thinkbot</h2>
<p>thinkbot harnesses the power of a <a href="http://aws.amazon.com/">complex computing cluster</a> and offers it to you via a friendly REST API. This allows you easily to setup and access sophisticated simulations from various contexts&mdash;a command line, a browser window, or even your mobile device!</p>
<p>All requests to thinkbot are required to be over SSL and begin with:</p>
<pre class="prettyprint lang-py"><code>https://thinkbot.net/api/v1/
</code></pre>
<p>You generally need to authenticate with thinkbot when interacting with it. This is easily done as you'll soon see with your personal authentication token, <code>superlonggibberishstring</code>, that you can find in <a href="https://thinkbot.net/dashboard/">your dashboard</a>. Please keep this a secret.</p>
<p>You're now ready for your very first interaction with thinkbot. We're going to submit a one-line Python script using <code>curl</code>.</p>
<pre class="prettyprint lang-py"><code>curl -X POST https://thinkbot.net/api/v1/jobs/
     -H "Authorization:  Token superlonggibberishstring" \
     -F "name=My first thinkbot calculation" \
     -F "environment=python27" \
     -F "code=print 1 + 2"
</code></pre>
<p>Once submitted, thinkbot puts your script into a queue and immediately responds with some handy information about your request:</p>
<pre class="prettyprint lang-py"><code>{
    "url": "http://thinkbot.net/api/v1/jobs/job_id/",
    "status": "submitted",
    "owner": "researcher",
    "created": "2013-08-22T11:36:58.907Z",
    "name": "My first thinkbot calculation",
    "environment": "python27",
    "code": "print 1 + 2",
    .
    .
    .
}
</code></pre>
<p>The critical piece of information here is the <code>url</code> field. This is how you can look up the status of your script in the future, as well as retrieve interesting results from it. So let's use it to check up on our simple Python one-liner:</p>
<pre class="prettyprint lang-py"><code>curl -X GET https://thinkbot.net/api/v1/jobs/job_id/ \
     -H "Authorization:  Token superlonggibberishstring"
</code></pre>
<h2 id="more-realistic-usage">More realistic usage</h2>
<p>thinkbot supports a variety of programming environments </p>
<p>The simplest way to interact with thinkbot is to submit some code that you'd like to run,</p>
<p><code>curl -X PUT https://thinkbot.net/api/v1/jobs/</code></p>


<h2 id="overview">Getting started with the API</h2>



<h3 id="authenticating">Authenticating</h3>
<p class="text-muted">To be written.</p>

<!--
    <tr class="danger">
      <td><code>GET</code></td>
      <td><code>/users/{user_id}/token</code></td>
      <td>Authenticate user for current session</td>
    </tr>
    -->
<h3 id="examples">Example usage</h3>
<p class="text-muted">To be written.</p>

<h2 id="resources">All resources</h2>

<h3 id="users">Users</h3>
<div class="table-responsive">
  <table class="table">
    <thead>
      <tr>
        <th>Method</th>
        <th>Slug</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>POST</code></td>
        <td><code>/users/</code></td>
        <td>Create or sign-up a new user</td>
      </tr>
      <tr>
        <td><code>GET</code></td>
        <td><code>/users/{id}/</code></td>
        <td>Retrieve specific user information</td>
      </tr>
      <tr>
        <td><code>PUT</code></td>
        <td><code>/users/{id}/</code></td>
        <td>Update specific user information</td>
      </tr>
      <tr>
        <td><code>DELETE</code></td>
        <td><code>/users/{id}/</code></td>
        <td>Delete specific user</td>
      </tr>
    </tbody>
  </table>
</div>

<h3 id="environments">Environments</h3>
<p>In addition to the <a href="">standard environments</a> that thinkbot comes prebuilt with, you can define and use your own software environments.</p>
<div class="table-responsive">
  <table class="table">
    <thead>
      <tr>
        <th>Method</th>
        <th>Slug</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>POST</code></td>
        <td><code>/environments/</code></td>
        <td>Define a new software environment</td>
      </tr>
      <tr>
        <td><code>GET</code></td>
        <td><code>/environments/{id}/</code></td>
        <td>Retrieve specific environment information</td>
      </tr>
      <tr>
        <td><code>PUT</code></td>
        <td><code>/environments/{id}/</code></td>
        <td>Update specific environment information</td>
      </tr>
      <tr>
        <td><code>DELETE</code></td>
        <td><code>/environments/{id}/</code></td>
        <td>Delete specific environment</td>
      </tr>
    </tbody>
  </table>
</div>

<h3 id="jobs">Jobs</h3>
<div class="table-responsive">
  <table class="table">
    <thead>
      <tr>
        <th>Method</th>
        <th>Slug</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>POST</code></td>
        <td><code>/jobs/</code></td>
        <td>Submit a new job</td>
      </tr>
      <tr>
        <td><code>GET</code></td>
        <td><code>/jobs/{id}/</code></td>
        <td>Query specific job status</td>
      </tr>
      <tr>
        <td><code>GET</code></td>
        <td><code>/jobs/{id}/results/{id}</code></td>
        <td>Retrieve specific job results</td>
      </tr>
      <tr>
        <td><code>PUT</code></td>
        <td><code>/jobs/{id}/</code></td>
        <td>Update specific job</td>
      </tr>
      <tr>
        <td><code>DELETE</code></td>
        <td><code>/jobs/{id}/</code></td>
        <td>Delete specific job</td>
      </tr>
    </tbody>
  </table>
</div>

<h3 id="sessions">Sessions</h3>
<p>Sometimes, the program you want to run can&#8217;t be neatly broken down into a <a href="#jobs">stateless job script</a> that you can submit and check on later. To run such programs more interactively, you need to employ a compute session.</p>
<div class="table-responsive">
  <table class="table">
    <thead>
      <tr>
	<th>Method</th>
	<th>Slug</th>
	<th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
	<td><code>POST</code></td>
	<td><code>/sessions/</code></td>
	<td>Initialise a new compute session</td>
      </tr>
      <tr>
	<td><code>GET</code></td>
	<td><code>/sessions/{id}/</code></td>
	<td>Query specific session state</td>
      </tr>
      <tr>
	<td><code>PUT</code></td>
	<td><code>/sessions/{id}/</code></td>
	<td>Update specific session state</td>
      </tr>
      <tr>
	<td><code>DELETE</code></td>
	<td><code>/sessions/{id}/</code></td>
	<td>Close specific session</td>
      </tr>
    </tbody>
  </table>
</div>
{% endblock %}
